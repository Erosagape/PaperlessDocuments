
@{
    ViewBag.Title = "Import Customers";
}

<h2>Import Customers</h2>
@if (ViewBag.DataSource != null)
{
    var tb = (System.Data.DataTable)ViewBag.DataSource;
    if (tb.Rows.Count > 0)
    {
        <table border="1">
            <thead>
                <tr>
                    @for (var c = 0; c < tb.Columns.Count; c++)
                    {
                        <th>@tb.Rows[0][c].ToString()</th>
                    }
                </tr>
            </thead>
            <tbody>
                @for (var r = 1; r < tb.Rows.Count; r++)
                {
                    <tr>
                        @for (var c = 0; c < tb.Columns.Count; c++)
                        {
                            <td>@tb.Rows[r][c].ToString()</td>
                        }
                    </tr>
                }
            </tbody>
        </table>
    }
}
else
{
    <form method="post" action="@Url.Action("ImportData","Excel")" enctype="multipart/form-data">
        <input type="file" name="fileUpload" />
        <input type="submit" value="Upload" />
        @ViewBag.Message<br />
        Sheet No : <input type="number" name="sheetno" value="0" /> <br />
        Start At Row : <input type="number" name="rowstart" value="2" /> <br />
        Table : <input type="text" name="tablename" value="CounterCustomer" /><br />
        <input type="hidden" name="returnto" value="ImportCustomers" />
        <input type="hidden" name="primarykey" value="fld4" />
        <b>Mapping Field</b>
        <table>
            <tr>
                <td>
                    <input type="text" name="fld0" value="companycode" />
                    <input type="text" name="typ0" value="FIX" />
                </td>
                <td>
                    <input type="text" name="col0" value="" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld1" value="datagroup" />
                    <input type="text" name="typ1" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col1" value="0" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld2" value="dataid" />
                    <input type="text" name="typ2" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col2" value="1" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld3" value="contractid" />
                    <input type="text" name="typ3" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col3" value="2" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld4" value="taxreference" />
                    <input type="text" name="typ4" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col4" value="3" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld5" value="companynameth" />
                    <input type="text" name="typ5" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col5" value="4" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld6" value="companynameen" />
                    <input type="text" name="typ6" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col6" value="5" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld7" value="companycontact" />
                    <input type="text" name="typ7" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col7" value="6" />
                </td>
            </tr>
            <tr>
                <td>
                    <input type="text" name="fld8" value="addressth" />
                    <input type="text" name="typ8" value="IDX" />
                </td>
                <td>
                    <input type="text" name="col8" value="7" />
                </td>
            </tr>
        </table>
    </form>
}
<script type="text/javascript">
    var msg = '@ViewBag.Message';
    if (msg !== 'Ready') {
        alert(msg);
    }
</script>